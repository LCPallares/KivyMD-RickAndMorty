# Custom widget for displaying info labels
<InfoLabel2@MDBoxLayout>:
    title: ""
    value: ""
    orientation: 'horizontal' # Added orientation for InfoLabel
    size_hint_y: None # Added size_hint_y for InfoLabel
    height: dp(40) # Added height for InfoLabel
    spacing: dp(5) # Added spacing for InfoLabel

    MDCard: # Changed to MDCard to support radius and md_bg_color
        #md_bg_color: self.theme_cls.onPrimaryFixedColor # Comentado para 1.1.1
        radius: dp(5), dp(5), dp(5), dp(5)
        padding: dp(5) # Usar dp
        size_hint_x: 0.3
        MDLabel:
            text: root.title
            #theme_text_color: "Custom" # Comentado para 1.1.1
            text_color: "white"
            halign: "center"
    MDCard: # Changed to MDCard to support radius and md_bg_color
        #md_bg_color: self.theme_cls.onSecondaryColor # Comentado para 1.1.1
        radius: dp(5), dp(5), dp(5), dp(5)
        padding: dp(5) # Usar dp
        size_hint_x: 0.6
        MDLabel:
            text: root.value
            halign: "center"


<InfoLabel@MDBoxLayout>:
    title: ""
    value: ""
    MDBoxLayout:
        #md_bg_color: self.theme_cls.onPrimaryFixedColor
        #radius: dp(5), dp(5), dp(5), dp(5)
        padding: "5dp"
        size_hint_x: 0.3
        MDLabel:
            text: root.title
            #theme_text_color: "Custom"
            text_color: "white"
            halign: "center"

    MDBoxLayout:
        #md_bg_color: self.theme_cls.onSecondaryColor
        #radius: dp(5), dp(5), dp(5), dp(5)
        padding: "5dp"
        size_hint_x: 0.6
        MDLabel:
            text: root.value
            halign: "center"



<CharacterDetailScreen>:
    #md_bg_color: self.theme_cls.backgroundColor # Comentado para 1.1.1
    #md_bg_color: self.theme_cls.onPrimaryColor # Comentado para 1.1.1

    MDBoxLayout:
        orientation: 'vertical'
        #spacing: dp(5) # Comentado, ajustar si es necesario

        # BARRA SUPERIOR - Adaptado a KivyMD 1.1.1 (MDToolbar)
        MDTopAppBar:
            id: top_app_bar
            title: "Character detail" # Título directo en MDToolbar
            elevation: 2
            # 'type' property is not available in MDToolbar (1.1.1)
            
            # BOTONES IZQ - Usando left_action_items
            left_action_items: [["arrow-left", lambda x: app.change_screen('characters_list')]] # Example: Go back to list

        # IMAGEN
        MDBoxLayout:
        # Changed to MDCard to allow radius and elevation, if desired for the container
        # MDCard: 
            size_hint_y: 0.49
            padding: dp(28)
            #radius: dp(50), dp(50), dp(50), dp(50) # If using MDCard above
            
            # Usando Image en lugar de FitImage (FitImage no es estándar en 1.1.1)
            FitImage:
                source: root.character_image
                pos_hint: {"top": 1}
                # radius property removed as Image does not support it directly.
                # If rounded images are needed, consider a custom Kivy solution or a texture mask.
                radius: dp(36), dp(36), dp(36), dp(36) # Comentado, no soportado directamente por Image

        # CONTENIDO - Cambiado a MDCard para admitir radio y elevación
        MDCard:
            orientation: "vertical"
            size_hint_y: 0.51
            height: self.minimum_height
            padding: dp(16)
            spacing: dp(10)
            pos_hint: {"center_x": .5, "y": 0} # Stick to the bottom
            radius: dp(36), dp(36), 0, 0 # Radius only on top corners
            #md_bg_color: self.theme_cls.backgroundColor # Comentado para 1.1.1
            #md_bg_color: self.theme_cls.onPrimaryColor # Comentado para 1.1.1
            elevation: 0

            # Primario - Cambiado a MDCard para admitir radio
            MDBoxLayout:
                #orientation: "vertical"
                #size_hint_y: None
                #height: dp(50)
                
                adaptive_height: True
                #md_bg_color: app.theme_cls.errorColor
                size_hint_y: 0.03
                # TITULO Y ESPECIE
                MDBoxLayout:
                    orientation: "vertical"
                    pos_hint: {"center_y": .5}
                    size_hint_x: 0.8 # Give more space to text
                    #md_bg_color: app.theme_cls.onErrorColor # Comentado para 1.1.1
                    MDLabel:
                        text: root.character_name
                        bold: True
                        adaptive_height: True
                        font_style: "H5" # Changed from "Headline" (2.x)
                        #role: "small" # Comentado, 'role' es 2.x
                        pos_hint: {"center_y": .5}
                        #text_color: app.theme_cls.primaryColor # Comentado para 1.1.1
                    MDLabel:
                        text: root.character_species
                        #theme_text_color: "Secondary" # Comentado para 1.1.1
                        adaptive_height: True

                # BOTÓN FAVORITO
                MDIconButton:
                    id: favorite_btn
                    icon: "heart" if root.is_favorite else "heart-outline"
                    theme_icon_color: "Custom" # Comentado para 1.1.1
                    icon_color: (1, 0, 0, 1) if root.is_favorite else (1, 1, 1, 1)
                    pos_hint: {"center_y": .5}
                    on_release: root.toggle_favorite()
                    # on_release: root.controller.toggle_favorite(root.character) # Si el controlador maneja esto

            # TEXTO "About the character"
            MDLabel:
                text: "About the character"
                adaptive_height: True
                padding_y: dp(10)
                halign: "center"
                bold: True
                #text_color: app.theme_cls.primaryColor # Comentado para 1.1.1
                font_style: "H6" # Changed from "Title" (2.x)
                #role: "medium" # Comentado, 'role' es 2.x
                
            MDGridLayout:
                cols: 1
                spacing: dp(10)
                padding_y: dp(10)
                adaptive_height: True
                #md_bg_color: app.theme_cls.inversePrimaryColor
                #md_bg_color: app.theme_cls.onPrimaryFixedColor
                radius: dp(15), dp(15), dp(15), dp(15)
                size_hint_y: 0.1

                InfoLabel:
                    title: "Status"
                    value: root.character_status
                InfoLabel:
                    title: "Gender"
                    value: root.character_gender
                InfoLabel:
                    title: "Origin"
                    value: root.character_origin
                InfoLabel:
                    title: "Location"
                    value: root.character_location
                InfoLabel:
                    title: "Created"
                    value: root.character_created
